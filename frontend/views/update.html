<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QnA 수정</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"> </script>
</head>

<body>
    <div class="updateContainer">
        <div class="updateContent">
            <h1 class="updateTitle">문의 글 수정</h1>
            <div class="updateWrap">
                <form id="updateForm" action="http://127.0.0.1:3000/qn-a/update">
                    <input type="text" name="nick_name" value="god_kkh" hidden>
                    <label for="">제목 수정</label>
                    <textarea name="qna_title" id="titleInput" placeholder="" cols="50" rows="1"></textarea>
                    <label for="">내용 수정</label>
                    <textarea name="qna_content" id="contentInput" placeholder="수정할 내용을 입력해주세요" cols="130"
                        rows="50"></textarea>
                    <button type="button" id="updateBtn">문의 글 수정</button>
                    <button type="button" id="backBtn">뒤로 가기</button>
                </form>
            </div>
        </div>
    </div>
</body>
<script>
    const listIndex = new URLSearchParams(location.search).get("id")
    console.log(listIndex);

    const title = document.getElementById('titleInput');
    const content = document.getElementById('contentInput');
    const updateBtn = document.getElementById('updateBtn');
    const backBtn = document.getElementById('backBtn');

    async function get() {
        const data = await axios.get(`http://127.0.0.1:3000/qn-a/detail/${listIndex}`);
        console.log(data.data);
        console.log(data.data.qna_title);
        title.placeholder = data.data.qna_title
        content.placeholder = data.data.qna_content
    }
    get();


    updateBtn.addEventListener('click', async () => {
        const value = {
            qna_title: title.value,
            qna_content: content.value
        }
        const data = await axios.put(`http://127.0.0.1:3000/qn-a/${listIndex}`, value);
        if (data.data > 0) {
            location.href = `http://127.0.0.1:5501/frontend/views/detail.html?id=${listIndex}`;
        }
    })

    backBtn.addEventListener('click', async () => {
        location.href = `detail.html?id=${listIndex}`
    })
    // const data = "?id=1&name=123"
    // const _data = data.replace('?', '')
    // console.log(_data);
    // const sliceData = _data.split('&');
    // const sliceData2 = sliceData2.split(',');
    // sliceData.forEach((number) => {
    //     console.log(number);
    // });

    // = 잘라서 id, 1, name, hyeok 만들어보기

    // const url = new URL(`http://127.0.0.1:3000/qn-a?id=`)
    // const params = data.data.id

    // axios.put(`http://127.0.0.1:3000/qn-a/${id}`, {
    //     title: qna_title.value,
    //     content: qna_title.value
    // })
    //     .then(function (response) {
    //         console.log(response);
    //         return response;
    //     })
    //     .catch(function (error) {
    //         console.log(error);
    //     })

    // const data = axios.put(`http://127.0.0.1/qn-a/${}`)

    // function getQueryParamsAsArray() {
    //     const params = new URLSearchParams(window.location.search);
    //     const queryParamsArray = [];
    //     for (const [key, value] of params.entries()) {
    //         queryParamsArray.push([key, value]);
    //     }
    //     return queryParamsArray;
    // }

    // axios.get('http://127.0.0.1:3000/qn-a', {
    //     params: {
    //         id: 1,
    //         name: 123
    //     }
    // })
    // let arr = [];
    // arr[0].push = "id", "1"
    // arr[1].push = "name", "123"
    // location.search = `${arr[0][1]}`// ?id=1&name=123 ==> [["id", "1"],["name", "123"]]
    // // arr[0][1]
    // console.log(arr);
    // console.log(location.search);
    // // const { data } = axios.get(`http://127.0.0.1:3000/qn-a/?${location.search}`)

    // document.getElementById('update').addEventListener('click', async event => {
    //     const nick_name = "god_kkh"
    //     const qna_title = document.getElementById('titleInput').value;
    //     const qna_content = document.getElementById('contentInput').value;

    //     const data = await axios.put(`http://127.0.0.1:3000/qn-a/update/${id}`, { nick_name, qna_title, qna_content })
    //     location.href = "QnA.html"
    // })
</script>

</html>